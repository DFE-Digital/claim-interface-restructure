{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/tabs/macro.njk" import govukTabs %}
{% from "govuk/components/table/macro.njk" import govukTable %}

{% extends "layout.html" %}

{% block pageTitle %}
  Viewing student loan for claim ABN7HA for student loans
{% endblock %}

{% block header %}
  {% include "includes/cookie-banner.html" %}
  {# Set serviceName in config.js. #}
  {{ govukHeader({
    serviceName: serviceName,
    serviceUrl: "/",
    navigation: [
      {
        href: "/claims",
        text: "View claims",
        attributes: {
          "data-install": "View claims"
        }
      },
      {
        href: "/admin/claims/search",
        text: "Search",
        attributes: {
          "data-tutorials": "Search"
        }
      },
      {
        href: "/admin/payroll_runs",
        text: "Payroll",
        attributes: {
          "data-about": "Payroll"
        }
      },
      {
        href: "/admin/policy_configurations",
        text: "Open/close a service",
        attributes: {
          "data-about": "Payroll"
        }
      },
      {
        href: "/admin/auth/sign-out",
        text: "Sign out",
        attributes: {
          "data-about": "Sign out"
        }
      }
    ]
  }) }}
{% endblock %}

{% block content %}

{% set service_name = "Teachers: claim back your student loan repayments" %}
{% set reference = "ABN7HA" %}
{% set check_title = "Student loan amount" %}
{% set trn = "2783017" %}
{% set name = "Fred Smith" %}
{% set dob = "21 August 1979" %}
{% set email = "freddysmith@gmail.com" %}
{% set ticketURL = "https://additional-teaching-payment.zendesk.com/agent/tickets/1234" %}
{% set claimNotes = "Spoke with claimant on 13/01, started working in the school sept 18

Salary between sept 18 and Apr 19 - £XX, XXX. He can't remember how he calculated repayments but thinks he probably added together payslips

{SO NAME} - HL data only available from July/18, May need another Loan to high call to find out if remaining FY18/19 income (April18-June/18) is teaching

related or not (i.e supply teacher)

3 March 2020 - loan too high email sent, reply due 10 March

4 March - reply received with repayments totalling £331. Have asked claimant to confirm his claim amount. Awaiting reply.

6 March - reply received from claimant confirming £331 is correct amount. Claimant will need to re-apply.

10 March  agreed that a developer could ammend the claim. Ammended and approved. KB" %}

{% include "includes/claim-header-block.html" %}

{% set checksHtml %}

 {% if data['student-loan-task-zendesk-url'] %}
      <div class="flash-card govuk-!-margin-bottom-9">
        <header>
          <h3 class="govuk-heading-m">This claim has a support ticket assigned</h3>
        </header>
        <div class="govuk-grid-row">
          <div class="govuk-grid-column-full">
            <p>This claim has a support ticket assigned to it for the student loan. Check it's current state before completing this task.</p>
            <p><a href="{{ data['student-loan-task-zendesk-url']}}">View the support ticket</a></p>
          </div>
        </div>
      </div>
{% endif %}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

    <dl class="govuk-summary-list govuk-!-margin-bottom-9">

        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Student loan repayment amount
          </dt>

          <dd class="govuk-summary-list__value">
            £456
          </dd>
        </div>
        <div class="govuk-summary-list__row">
          <dt class="govuk-summary-list__key">
            Student loan plan
          </dt>

          <dd class="govuk-summary-list__value">
            Plan 1
          </dd>
        </div>
    </dl>


    <form class="new_check" id="claim_check_form" action="/claim/student-loan/student-loan" accept-charset="UTF-8" method="post">
            <div class="govuk-form-group">
              <fieldset class="govuk-fieldset govuk-!-margin-bottom-6">
                <legend class="govuk-fieldset__legend govuk-fieldset__legend--l govuk-!-margin-bottom-6">
                  <h3 class="govuk-heading-l govuk-!-margin-0">
                    Does the claimant’s student loan amount and plan type match the information we hold about their loan?
                  </h3>
                </legend>

                <div class="govuk-radios govuk-radios--conditional" data-module="govuk-radios">
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="loanAmount1" name="loanAmount" type="radio" value="Yes">
                    <label class="govuk-label govuk-radios__label" for="loanAmount1">
                      Yes
                    </label>
                  </div>

                  <div class="govuk-radios govuk-radios--conditional" data-module="govuk-radios">
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="loanAmount2" name="loanAmount" type="radio" value="No">
                    <label class="govuk-label govuk-radios__label" for="loanAmount2">
                      No
                    </label>
                  </div>
                  <div class="govuk-radios__divider">or</div>
                  <div class="govuk-radios__item">
                    <input class="govuk-radios__input" id="loanAmount3" name="loanAmount" type="radio" value="text" data-aria-controls="conditional-loanAmount3">
                    <label class="govuk-label govuk-radios__label" for="loanAmount3">
                      Start support process
                    </label>
                  </div>
                  <div class="govuk-radios__conditional govuk-radios__conditional--hidden" id="conditional-loanAmount3">
                    <div class="govuk-form-group">
                    <label class="govuk-label" for="ticketURL">
                        Link to support ticket
                      </label>
                      <span class="govuk-hint">
                        If you need further evidence to answer this question you
                        can <a href="https://additional-teaching-payment.zendesk.com/agent/tickets/new/1" target="_blank">
                        raise a support ticket <span class="govuk-visually-hidden">opens in a new window,</span></a>.
                        <br><br>Then paste the URL of the ticket in the text box below.
                      </span>
                      <input class="govuk-input" id="ticketURL" name="ticketURL" type="url" placeholder="https://" value="{{ data['student-loan-task-zendesk-url']}}">
                    </div>

                  </div>
                </div>
              </div>
            </fieldset>
            <input type="submit" name="commit" value="Save and continue" class="govuk-button" data-disable-with="Save and continue">
        </div>
      </form>
  </div>
</div>
{% endset -%}

{% set claimNotesHtml %}
<div class="govuk-grid-row">
 <div class="govuk-grid-column-two-thirds">
      <h2 class="app-task-list__section">
        Support Ticket
      </h2>

      <input class="govuk-input" id="ticketURL" name="ticketURL" type="text" value="{{ data["ticketURL"] }}">

      <h2 class="app-task-list__section">
        Claim Notes
      </h2>
      <span class="govuk-hint">
        Enter a breif decsription of the problem/steps take to resolve the problem
        in the format Initals - Date - Message
      </span>
      <textarea class="govuk-textarea" id="claimNotes" name="claimNotes" rows="12" >{{ claimNotes }}</textarea>

      {{ govukButton({
        text: "Save Support Information",
        classes: "govuk-button--secondary"
      }) }}
    </div>
  </div>
{% endset -%}

{% set pastWeekHtml %}
<h2 class="govuk-heading-l">CLAIM TIMELINE</h2>
TIMELINE GOES HERE
{% endset -%}

{{ govukTabs({
  items: [
    {
      label: "Checks",
      id: "checks",
      panel: {
        html: checksHtml
      }
    },
    {
      label: "Notes",
      id: "notes",
      panel: {
        html: claimNotesHtml
      }
    },
    {
      label: "Claim History",
      id: "claimHistory",
      panel: {
        html: pastWeekHtml
      }
    }
  ]
}) }}


  </div>

{% endblock %}
